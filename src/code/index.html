<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PSK App Core</title>
    PLACEHOLDER_THAT_WILL_BE_REPLACED_BY_SW_OR_SERVER_WITH_BASE_TAG
    <script src="scripts/bundles/iframeBoot.js"></script>
    <script src="../../nativeBridge.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <link href="webcardinal/webcardinal.css" rel="stylesheet" type="text/css">

    <!-- Ionic dist -->
    <link rel="stylesheet" href="ionic/css/css/ionic.bundle.css">
    <script type="module" src="ionic/dist/ionic/ionic.esm.js"></script>

    <!-- Ionicons dist -->
    <script type="module" src="ionic/icons/ionicons/ionicons.esm.js"></script>

    <!-- Ion Web Cardinal dist -->
    <script type="module" src="webcardinal/webcardinal.js"></script>

    <script src="socket.io.msgpack.min.js"></script>

    <script type="text/javascript">
		(function(d, script) {
			script = d.createElement('script');
			script.type = 'text/javascript';
			script.async = true;
			script.onload = function(){
				console.log("Camera.js bundle has loaded.");
			};

			script.onerror = function(){
				console.log("Camera.js not available! Take note that some native APIs we will not work!");
			};

			let baseURL = window.top.location.href;

			if(window.top.location.hash !== ""){
				baseURL = baseURL.replace(window.top.location.hash, "");
			}

			if(window.top.location.search !== ""){
				baseURL = baseURL.replace(window.top.location.search, "");
			}

			//if the url contains a file name like index.html or other we remove it
			if(baseURL.split('/').pop().indexOf('.') > -1){
				baseURL = baseURL.replace(baseURL.split('/').pop(), "");
			}

			if(baseURL[baseURL.length-1] !== "/"){
				baseURL +="/";
			}

			script.src = baseURL+'camera.js';

			d.getElementsByTagName('head')[0].appendChild(script);
		}(document));
    </script>

    <script type="text/javascript">
        if (window.frameElement) {
            const iframeIdentity = window.frameElement.getAttribute('identity');

            if (iframeIdentity) {
                window.parent.document.dispatchEvent(new CustomEvent(iframeIdentity, {
                    detail: {
                        status: 'completed'
                    }
                }));
                console.log("Index page Event Dispatched...")
            }
        }
    </script>
</head>

<body>
<webc-app-root>
    <webc-app-container>
        <webc-app-router></webc-app-router>
    </webc-app-container>
</webc-app-root>
</body>
</html>
